<script type="text/javascript" src="prototype.js"></script>
<script type="text/javascript">
    function copy_ship_info() {
        if (!(document.billing.check1.checked)) {
            document.billing.billing_firstname.value = "";
            document.billing.billing_lastname.value = "";
            document.billing.billing_company.value = "";
            document.billing.billing_address.value = "";
            document.billing.billing_address2.value = "";
            document.billing.billing_city.value = "";
            document.billing.billing_phone.value = "";
            document.billing.billing_zip.value = "";
        }
        else {
            document.billing.billing_firstname.value = "[shipping_firstname]";
            document.billing.billing_lastname.value = "[shipping_lastname]";
            document.billing.billing_company.value = "[shipping_company]";
            document.billing.billing_address.value = "[shipping_address]";
            document.billing.billing_address2.value = "[shipping_address2]";
            document.billing.billing_city.value = "[shipping_city]";
            document.billing.billing_phone.value = "[shipping_phone]";

            country_object = "document.billing.billing_country";
            state_object = "document.billing.billing_state";

            document.billing.billing_state.value = "[shipping_state]";

            document.billing.billing_zip.value = "[shipping_zip]";
            select_field(country_object, "[shipping_country]");
            document.billing.action = "checkout3.asp?step=3&action=updatecountry&billing_state=[shipping_state]";
            document.billing.submit();
        }
    }
</script>

<section id="checkoutStep3Multiple">
  <h1 class="page_headers">Checkout</h1>
  <div class="steps right">[checkout1_step] [checkout2_step]<span class="steps_on">[checkout3_step] </span> [checkout4_step]</div>
  <div class="clear"></div>
  <!--START: CATEGORY_HEADER-->
  <div id="checkoutStep3Header">[CONTENT]</div>
  <!--END: CATEGORY_HEADER-->
  <form name="billing" method="post" action="checkout4.asp?step=4">
    <div class="rightCol">
      <div class="header">
        <h3 class="checkout-headers">[checkout3_Header-ordersummary]</h3>
        <div class="clear"></div>
      </div>
      <div class="orderSummary pad10 boxShadow">
        <div class="total_items">[shoppingcart_subtotal]</div>
        <div class="total_subtotal">[SUBTOTAL]</div>
        <div class="clear"></div>
        <div class="total_discount-detail">[shoppingcart_discount]:</div>
        <div class="total_discount">- [DISCOUNT]</div>
        <div class="clear"></div>
        <div class="total_cart-shipping">[shoppingcart_shipping]</div>
        <div class="total_shipping">[SHIPPING]</div>
        <div class="clear"></div>
        <div class="total_cart-taxes">[shoppingcart_taxes]</div>
        <div class="total_taxes">[TAX]</div>
        <div class="clear"></div>
        <!--START: GIFTCERTS-->
        <div class="total_cart-total">[shoppingcart_total]</div>
        <div class="total_total">[TOTAL]</div>
        <div class="clear"></div>
        <div class="total_cart-giftcerts">[shoppingcart_giftcertificate]:</div>
        <div class="total_giftcerts">-[GIFTCERTS]</div>
        <div class="clear"></div>
        <!--END: GIFTCERTS-->
        <div id="divBalance">
          <div class="total_cart-balance">[shoppingcart_balance]</div>
          <div class="total_balance price">[BALANCE]</div>
          <div class="clear"></div>
        </div>
        </div>
      <div class="header">
        <h3 class="checkout-headers">[checkout2_Header-shippinginfo]</h3>
        <div class="clear"></div>
      </div>
      <div class="shippingInfo pad10 boxShadow">
        <p><strong>[checkout2_shippinginfomessage]</strong></p>
        <p>[shipping_firstname] [shipping_lastname]</p>
        <p>[shipping_company]</p>
        <p>[shipping_address]</p>
        <p>[shipping_address2]</p>
        <p>[shipping_city], [shipping_state] [shipping_zip] [shipping_country]</p>
        <div class="button left"><a href="checkout.asp?step=1" class="icon-btn icon-btn-edit">[checkout2_shippinginfochange]</a></div>
        <div class="clear"></div>
      </div>
    </div>
    <div class="leftCol">
      <div class="header">
        <h3 class="checkout-headers">[account_billing-info]</h3>
        <div class="clear"></div>
      </div>
      <div id="billing_info" class="pad10 boxShadow">
        <p>[checkout3_billingcomment]</p>
        <div class="chkField">
          <label for="billing_firstname">[CustomerInfo_firstname]</label>
          <input name="billing_firstname" type="text" id="shipping_firstname2" value="[billing_firstname]" size="15" tabindex="2" class="txtBoxStyle" />
          <!--START: req_billing_firstname--> 
          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /> 
          <!--END: req_billing_firstname-->
          <div class="clear"></div>
        </div>
        <div class="chkField">
          <label for="billing_lastname">[CustomerInfo_lastname]</label>
          <input name="billing_lastname" type="text" id="shipping_lastname3" value="[billing_lastname]" size="15" tabindex="3" class="txtBoxStyle" />
          <!--START: req_billing_lastname--> 
          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /> 
          <!--END: req_billing_lastname-->
          <div class="clear"></div>
        </div>
        <div class="chkField">
          <label for="billing_company">[CustomerInfo_company]</label>
          <input name="billing_company" type="text" id="shipping_company2" value="[billing_company]" size="25" tabindex="4" class="txtBoxStyle" />
          <div class="clear"></div>
        </div>
        <div class="chkField">
          <label for="billing_phone">[CustomerInfo_phone]</label>
          <input name="billing_phone" type="text" id="shipping_phone2" value="[billing_phone]" size="25" tabindex="5" class="txtBoxStyle" />
          <!--START: req_billing_phone--> 
          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /> 
          <!--END: req_billing_phone-->
          <div class="clear"></div>
        </div>
        <div class="chkField">
          <label for="billing_address">[CustomerInfo_address]</label>
          <input name="billing_address" type="text" id="shipping_address3" value="[billing_address]" size="25" tabindex="5" class="txtBoxStyle" />
          <!--START: req_billing_address--> 
          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /> 
          <!--END: req_billing_address-->
          <div class="clear"></div>
        </div>
        <div class="chkField">
          <label for="billing_address2">[CustomerInfo_address2]</label>
          <input name="billing_address2" type="text" id="shipping_address22" value="[billing_address2]" size="25" tabindex="6" class="txtBoxStyle" />
          <div class="clear"></div>
        </div>
        <div class="chkField">
          <label for="billing_city">[CustomerInfo_city]</label>
          <input name="billing_city" type="text" id="shipping_city2" value="[billing_city]" size="25" tabindex="7" class="txtBoxStyle" />
          <!--START: req_billing_city--> 
          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /> 
          <!--END: req_billing_city-->
          <div class="clear"></div>
        </div>
        <div class="chkField">
          <label for="billing_country">[CustomerInfo_country]</label>
          <select name="billing_country" onchange="document.billing.action='checkout3_multiple.asp?step=3&action=updatecountry';document.billing.submit();" tabindex="8" class="txtBoxStyle" id="billing_country">
            [CountryDropDown]
          </select>
          <!--START: req_billing_country--> 
          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /> 
          <!--END: req_billing_country-->
          <div class="clear"></div>
        </div>
        <div class="chkField">
          <label for="billing_state">[CustomerInfo_state]</label>
          [state] 
          <!--START: req_billing_state--> 
          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /> 
          <!--END: req_billing_state-->
          <div class="clear"></div>
        </div>
        <div class="chkField">
          <label for="billing_zip">[CustomerInfo_zip]</label>
          <input name="billing_zip" maxlength="15" type="text" id="billing_zip" value="[billing_zip]" size="10" tabindex="10" class="txtBoxStyle" />
          <!--START: req_billing_zip--> 
          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /> 
          <!--END: req_billing_zip-->
          <div class="clear"></div>
        </div>
        <div class="clear"></div>
      </div>
      <!--START: samebilling_billing--> 
      <!--start billing same as shipping--> 
      <!--START: showsamebillingasshipping-->
      <div class="header">
        <h3 class="checkout-headers">[checkout3_Header-billingaddress]</h3>
        <div class="clear"></div>
      </div>
      <div class="billingAddress pad10 boxShadow">
        <p>[billing_firstname] [billing_lastname]</p>
        <!--START: billing_company-->
        <p>[billing_company]</p>
        <!--END: billing_company-->
        <p>[billing_address]</p>
        <!--START: billing_address2-->
        <p>[billing_address2]</p>
        <!--END: billing_address2-->
        <p>[billing_city], [billing_state] [billing_zip] [billing_country]</p>
        <div class="button left"><a href="checkout.asp?step=1" class="icon-btn icon-btn-geopin">[checkout2_shippinginfochange]</a></div>
        <div class="clear"></div>
      </div>
      <!--END: showsamebillingasshipping-->
      <input name="billing_firstname" type="hidden" id="Hidden1" value="[shipping_firstname]" />
      <input name="billing_lastname" type="hidden" id="Hidden2" value="[shipping_lastname]" />
      <input name="billing_company" type="hidden" id="Hidden3" value="[shipping_company]" size="25" />
      <input name="billing_phone" type="hidden" id="Hidden4" value="[shipping_phone]" size="25" />
      <input name="billing_address" type="hidden" id="Hidden5" value="[shipping_address]" size="25" />
      <input name="billing_address2" type="hidden" id="Hidden6" value="[shipping_address2]" size="25" />
      <input name="billing_city" type="hidden" id="Hidden7" value="[shipping_city]" size="25" />
      <input name="billing_country" type="hidden" value="[shipping_country]" />
      <input name="billing_state" type="hidden" id="Hidden8" value="[shipping_state]" />
      <input name="billing_zip" type="hidden" id="Hidden9" value="[shipping_zip]" />
      <!--end billing same as shipping--> 
      <!--END: samebilling_billing--> 
      <!--START: GIFTCERTIFICATES-->
      <div class="header">
        <h3 class="checkout-headers">[viewcart_giftcertificates-header]</h3>
      </div>
      <div class="displayGiftCertificates pad10 boxShadow"> 
        <!--START: DISPLAY_GIFTCERTIFICATES-->
        <input type="hidden" name="coupon" value="[id]" />
        <div class="row">
          <div class="certificate-name">[certificate_name]</div>
          <div class="certificate-amount"><strong>Amount:</strong> [discount_amount] <span>Balance after this order: [discount_balance]</span></div>
          <div class="clear"></div>
        </div>
        <!--END: DISPLAY_GIFTCERTIFICATES--> 
      </div>
      <!--END: GIFTCERTIFICATES-->
    </div>
    <div class="clear"></div>
      <div id="divPayment"> 
        <!--START: PAYMENT_BLOCK-->
        <div class="header">
          <h3 class="checkout-headers">[checkout3_methodofpaymentselect]</h3>
          <div class="clear"></div>
        </div>
        <div id="divPaymentMethods" class="pad10 boxShadow"> 
          <!--START: PPEXPRESS-->
          <div class="ppExpress">
            <h4>[payment_description]</h4>
            <div class="desc-message">[payment_description_message]</div>
            <div class="ppe-radio">
              <input name="payment" onclick="javascript: checkoutSwitch(true); window.location.href = 'paypal_express.asp?ch=0';" type="radio" value="online-[id]" />
            </div>
            <div class="ppe-logo"><img src="https://www.paypal.com/en_US/i/IntegrationCenter/scr/scr_ppAcceptMark_68x43.jpg" height="35" /></div>
            <div class="payment-desc">[payment_description]</div>
            <div class="clear"></div>
          </div>
          <!--END: PPEXPRESS--> 
          
          <!--START: CCGATEWAY-->
          <div class="ccGateway">
            <h4>
              <input onclick="javascript: checkoutSwitch(false); controlDivPayment('[id]');" name="payment" type="radio" value="online-[id]" [FIRSTOPTIONCHECKED] />
              [payment_description]</h4>
            <div class="clear"></div>
            <div id="divPaymentOption[id]" name="divPaymentOption">
              <div class="desc-message">[payment_description_message]</div>
              <div class="ccgField">
                <label for="creditcardnumber">[CustomerInfo_creditcardnumber]</label>
                <input type="text" onchange="clearContent(this);" name="ff[id]_ocardno" size="30" class="txtBoxStyle" />
                <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" />
                <div class="clear"></div>
              </div>
              <!--START: ccStartDate-->
              <div class="ccgField">
                <label for="creditstartdate">[CustomerInfo_creditstartdate]</label>
                <select name="ff[id]_ocardstartmonth" class="txtBoxStyle">
                  <option value=""></option>
                  
                    [monthlist]
                
                </select>
                <select name="ff[id]_ocardstartyear" class="txtBoxStyle">
                  <option value=""></option>
                  
                	[yearlistdtstart]
                
                </select>
                (Maestro, Solo and Amex only) <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" />
                <div class="clear"></div>
              </div>
              <!--END: ccStartDate-->
              <div class="ccgField">
                <label for="creditexpiration">[CustomerInfo_creditexpiration]</label>
                <select name="ff[id]_ocardexpiresmonth" class="txtBoxStyle">
                  
                	[monthlist]
                
                </select>
                <select name="ff[id]_ocardexpiresyear" class="txtBoxStyle">
                  
                	[yearlist]
                
                </select>
                <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" />
                <div class="clear"></div>
              </div>
              <div class="ccgField">
                <label for="cardtype">[CustomerInfo_cardtype]</label>
                <select name="ff[id]_ocardtype" class="txtBoxStyle">
                  
                	[cctype]
                
                </select>
                <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" />
                <div class="clear"></div>
              </div>
              <!--START: ccIssueNumber-->
              <div class="ccgField">
                <label for="creditissuenumber">[CustomerInfo_creditissuenumber]</label>
                <input type="text" name="ff[id]_ocardissue" maxlength="10" size="3" class="txtBoxStyle" />
                (Maestro and Solo only) <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" />
                <div class="clear"></div>
              </div>
              <!--END: ccIssueNumber-->
              <div class="ccgField">
                <label for="cvv2">CVV2</label>
                <input type="text" name="ff[id]_ocardcvv2" size="3" class="txtBoxStyle" />
                <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /><a href="#" onclick="javascript:window.open('assets/templates/common/images/cvv2.gif','new','menubars=no, resizable=no, statusbar=no, titlebar=no, width=300, height=500');" class="cvv2-help">What's this?</a>
                <div class="clear"></div>
              </div>
              <div class="clear"></div>
            </div>
          </div>
          <!--END: CCGATEWAY--> 
          
          <!--START: AUTHNETCIMBLOCK-->
          <div class="authneticIMBlock">
            <h4>
              <input onclick="javascript: checkoutSwitch(false); controlDivPayment('[id]CIM');" name="payment" type="radio" value="online-[id]-CIM" [FIRSTOPTIONCHECKED] />
              [payment_description]</h4>
            <div class="clear"></div>
            <div id="divPaymentOption[id]CIM" name="divPaymentOptionCIM"> 
              <!--START: authCIMBlock-->
              <div class="cimField">
                <label for="use-creditcard-on-file">[checkout3_use-creditcard-on-file]</label>
                <!--START: authCIMPaymentProfileItem-->
                <option value="authCIMProfileID_[custProfId]_[custPmntProfId]_[authCIMProfileID_cardlastdigits]_[authCIMProfileID_cardexp]"> [checkout3_creditcard-last-digits]: [authCIMProfileID_cardlastdigits] / [CustomerInfo_creditexpiration]: [authCIMProfileID_cardexp]</option>
                <!--END: authCIMPaymentProfileItem-->
                </select>
                <div class="clear"></div>
              </div>
              <!--END: authCIMBlock--> 
            </div>
          </div>
          
          <!--END: AUTHNETCIMBLOCK--> 
          
          <!--START: MILITARYSTAR-->
          <div class="militaryStar">
            <h4>
              <input type="hidden" value="1" name="ff[id]_isstarcard" id="ff[id]_isstarcard" />
              <input  onclick="javascript: checkoutSwitch(false); controlDivPayment('[id]');" name="payment" type="radio" value="online-[id]" [FIRSTOPTIONCHECKED] />
              [payment_description]</h4>
            <div class="clear"></div>
            <div id="div1" name="divPaymentOption">
              <div class="desc-message">[payment_description_message]</div>
              <div class="msField">
                <label for="ff[id]_ocardno">[CustomerInfo_creditcardnumber]</label>
                <input type="text" onchange="clearContent(this);" name="ff[id]_ocardno" size="30" class="txtBoxStyle" />
                <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" />
                <div class="clear"></div>
              </div>
            </div>
            <div class="clear"></div>
          </div>
          <!--END: MILITARYSTAR--> 
          
          <!--START: LINKGATEWAY-->
          <div class="linkGateway">
            <h4>
              <input onclick="javascript: checkoutSwitch(false); controlDivPayment('[id]');" name="payment" type="radio" value="online-[id]" [FIRSTOPTIONCHECKED] />
              [payment_description]</h4>
            <div class="clear"></div>
            <div id="div2" name="divPaymentOption">
              <div class="desc-message">[payment_description_message]</div>
              <div class="payment-desc">Pay [payment_description]</div>
              <div class="clear"></div>
            </div>
            <div class="clear"></div>
          </div>
          <!--END: LINKGATEWAY--> 
          
          <!--START: CUSTOM-->
          <div class="customGateway">
            <h4>
              <input onclick="javascript: checkoutSwitch(false); controlDivPayment('[id]');" name="payment" type="radio" value="offline-[id]" [FIRSTOPTIONCHECKED] />
              [payment_type]</h4>
            <div class="clear"></div>
            <div id="div3" name="divPaymentOption">
              <div class="payment-desc">[payment_description]</div>
              <div class="payment-type">[payment_type]</div>
              <!--START: CUSTOM_FIELD-->
              <div class="custField">
                <div class="cust-input">[InputName]</div>
                <div class="cust-field">[field]</div>
                <div class="clear"></div>
              </div>
              <!--END: CUSTOM_FIELD-->
              <div class="clear"></div>
            </div>
            <div class="clear"></div>
          </div>
          <!--END: CUSTOM-->
          <div class="clear"></div>
        </div>
        <div class="clear"></div>
        <!--END: PAYMENT_BLOCK--> 
      </div>
      <!--START: checkout_questions-->
      <div class="header">
        <h3 class="checkout-headers">[checkout1_checkoutquestions]</h3>
        <div class="clear"></div>
      </div>
      <div class="chkQuestions"> 
        <!--START: questions-->[questions]<!--END: questions-->
        <div class="clear"></div>
      </div>
      <!--END: checkout_questions-->
      <div id="divCheckoutComments">
        <div class="header">
          <h3 class="checkout-headers">[checkout3_Header-comment]</h3>
          <div class="clear"></div>
        </div>
        <div class="chkComments pad10 boxShadow">
          <label for="ocomment">[checkout3_commentmessage]</label>
          <textarea onchange="clearContent(this);" name="ocomment" class="txtBoxStyle" cols="55" rows="3"></textarea>
          <div class="clear"></div>
        </div>
      </div>
      <div id="divCheckoutButton"> 
          <span id="spanCheckout">
              <button type="button" name="btnCheckout" id="btnCheckout" onclick="javascript:submitCheckoutForm();" class="btn"><i class="icon-basket"></i> [checkout3_submitbutton]</button>
        </span>
      </div>
    </div>
    <!--START: checkout_questions_templates--> 
    <!--START: textarea-format--> 
    <!--START: req[id]--> 
    <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /> 
    <!--END: req[id]--> 
    [question]
    <textarea cols="30" rows="5" name="cq[id]" class="txtBoxStyle">[answer]</textarea>
    <!--END: textarea-format--> 
    <!--START: text-format--> 
    <!--START: req[id]--> 
    <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /> 
    <!--END: req[id]--> 
    [question]
    <input type="text" size="30" name="cq[id]" value="[answer]" class="txtBoxStyle" />
    <!--END: text-format--> 
    <!--START: checkbox-format--> 
    <!--START: req[id]--> 
    <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /> 
    <!--END: req[id]-->
    <input type="checkbox" name="cq[id]" class="txtBoxStyle" value="[answer]" [selected] />
    [question] 
    <!--END: checkbox-format--> 
    <!--START: radio-format--> 
    <!--START: req[id]--> 
    <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /> 
    <!--END: req[id]--> 
    [question] 
    <!--START: option-->
    <input type="radio" name="cq[id]" value="[option]" class="txtBoxStyle" [selected] />
    [option] 
    <!--END: option--> 
    <!--END: radio-format--> 
    <!--START: dropdown-format--> 
    <!--START: req[id]--> 
    <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /> 
    <!--END: req[id]--> 
    [question]
    <select name="cq[id]">
      <!--START: option-->
      <option value="[option]" [selected]>[option]</option>
      <!--END: option-->
    </select>
    <!--END: dropdown-format--> 
    <!--END: checkout_questions_templates-->
  </form>
  <div class="clear"></div>
  <!--START: CATEGORY_FOOTER-->
  <div id="checkoutStep3Footer">[CONTENT]</div>
  <!--END: CATEGORY_FOOTER--> 
</section>
<script type="text/javascript">
    //You should create the validator only after the definition of the HTML form
    var frmvalidator = new Validator("billing");
    frmvalidator.EnableMsgsTogether();

    function setValidation() {
        frmvalidator.clearAllValidations();

        frmvalidator.setAddnlValidationFunction("submitForm");

        frmvalidator.addValidation("billing_firstname", "req", "Please enter your First Name");
        frmvalidator.addValidation("billing_firstname", "maxlen=20", "Max length for First Name is 20");

        frmvalidator.addValidation("billing_lastname", "req", "Please enter your Last Name");
        frmvalidator.addValidation("billing_lastname", "maxlen=20", "Max length for Last Name is 20");

        if (get_Element('billing_country').value == "US") {
            frmvalidator.addValidation("billing_phone", "maxlen=18", "Max length for Phone is 18");
            frmvalidator.addValidation("billing_phone", "req", "Please enter your phone")
        }

        frmvalidator.addValidation("billing_address", "maxlen=50", "Max length for Address is 50");
        frmvalidator.addValidation("billing_address", "req", "Please enter your address");

        frmvalidator.addValidation("billing_address2", "maxlen=40", "Max length for Suite/Apt# is 40");

        frmvalidator.addValidation("billing_city", "maxlen=50", "Max length for City is 50");
        frmvalidator.addValidation("billing_city", "req", "Please enter your city");

        if (get_Element('billing_country').value == "US") {
            frmvalidator.addValidation("billing_state", "maxlen=50", "Max length for State is 50");
            frmvalidator.addValidation("billing_state", "req", "Please enter/select your state");
        }

        frmvalidator.addValidation("billing_zip", "maxlen=15", "Max length for Zip is 15");
        frmvalidator.addValidation("billing_zip", "req", "Please enter your zip code");

        frmvalidator.addValidation("billing_country", "dontselect=0");

        frmvalidator.addValidation("payment", "req", "Please select a payment option.");

        frmvalidator.setAddnlValidationFunction("checkotherreqfields");
    }

    function submitCheckoutForm() {
        objForm = document.billing;
        setValidation();
        if (objForm.onsubmit()) //triggers the form validation
            objForm.submit();
    }
</script>
