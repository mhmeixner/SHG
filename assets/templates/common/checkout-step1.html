<script type="text/javascript" src="state_countryjs.asp"></script>
<script src="prototype.js" language="javascript" type="text/javascript"></script>

<style>
#simplemodal-overlay {background-color:#000;}
</style>

<script type="text/javascript">
	if (typeof jQuery == 'undefined') {
	    document.write("<script type=\"text/javascript\" src=\"assets/templates/common/js/jquery.min.js\"></" + "script>");
	}
</script>

<form action="checkout2.asp?step=2" method="post" name="checkoutform">
    <input type="hidden" name="tknio" value="[tknio]">

  <table width="98%" cellpadding="0" cellspacing="0">
    <tr>
      <td class="page_headers"> Checkout</td>
      <td align="right" class="steps"><span class="steps_on">[checkout1_step]</span>[checkout2_step] [checkout3_step]
        [checkout4_step]</td>
    </tr>
    <tr>
      <td colspan="2">&nbsp;</td>
    </tr>
    <tr>
      <td colspan="2"><!--START: CATEGORY_HEADER-->
        
        <table width="100%" cellspacing="0" cellpadding="2" border="0">
          <tr>
            <td class="data"> [CONTENT]<br />
              <br /></td>
          </tr>
        </table>
        
        <!--END: CATEGORY_HEADER--></td>
    </tr>
    <!--START: paypalexpress-->
    <tr>
      <td colspan="2"><table border="0" cellpadding="0" cellspacing="0">
          <tr>
            <td width="39"><a href="paypal_express.asp?ch=1"> <img src="https://www.paypal.com/en_US/i/btn/btn_xpressCheckout.gif" border="0" align="left"
                                    style="margin-right: 7px;"></a></td>
            <td width="383" valign="top"><span style="font-size: 11px; font-family: Arial, Verdana;">Save time. Checkout securely.
              Pay without sharing your financial information.</span></td>
          </tr>
        </table></td>
    </tr>
    <!--END: paypalexpress--> 
    <!--START: GOOGLECHECKOUT-->
    <tr>
      <td colspan="2"><table border="0" cellpadding="0" cellspacing="0">
          <tr>
            <td><a href="google_checkout.asp"> <img name="Google Checkout" alt="Google Checkout" src="https://checkout.google.com/buttons/checkout.gif?merchant_id=[gc_merchantid]&w=180&h=46&style=white&variant=text&loc=en_US"
                                    height="46" width="180" border="0"></a></td>
          </tr>
        </table></td>
    </tr>
    <!--END: GOOGLECHECKOUT-->
    <tr>
      <td colspan="2"><table width="100%" cellpadding="2" cellspacing="0">
          <tr> 
            <!--column left-->
            <td valign="top" width="50%"><table width="100%" cellpadding="0" cellspacing="0">
                <!--START: account_login--> 
                <!--start current customer block-->
                <tr>
                  <td class="checkout-headers" align="left" colspan="2"> [checkout1_loginmessage]</td>
                </tr>
                <tr>
                  <td colspan="2"><table width="100%" cellpadding="4" cellspacing="0" class="alternative">
                      <tr>
                        <td class="item" height="40"> [checkout1_loginmessage2]</td>
                      </tr>
                      <tr>
                        <td align="left"><div style="float: left;">
                            <input type="button" value="[checkout1_login]" name="B3" onclick="document.location='checkout.asp?step=log-in';" class="btn" onmouseover="this.className='btn_over'" onmouseout="this.className='btn'" />
                          </div>
                          
                          <!--START: fbconnect-->
                          
                          <div style="float: left; margin: 2px 8px; padding: 0px;"><a onclick="popup('social_login.asp?p=fl&return=checkout',1000,550)" href="#" title="Sign in with Facebook"><img src="assets/templates/common/images/facebook_signin.png" alt="Sign in with Facebook" width="150" height="22" border="0" /></a></div>
                          
                          <!--END: fbconnect--></td>
                      </tr>
                    </table>
                    <br /></td>
                </tr>
                <!-- end current customer block--> 
                <!--start create account block-->
                <tr>
                  <td colspan="2">
                <tr>
                  <td class="checkout-headers" colspan="2"> [checkout1_Header-createnewaccount]</td>
                </tr>
                <tr>
                  <td colspan="2"><table width="100%" cellpadding="2" cellspacing="0" class="alternative">
                      <tr class="item">
                        <td width="34%" align="right" class="item"><strong>[CustomerInfo_email]:</strong></td>
                        <td width="66%"><input type="text" size="25" name="email" value="[email]" class="txtBoxStyle">
                          <!--START: emailrequired--> 
                          <!--START: req_email--> 
                          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" />
                          <!--END: req_email--> 
                          <!--END: emailrequired-->
                        </td>
                      </tr>
                      <!--START: confirm_email-->
                      <tr class="item">
                        <td align="right" class="item"><b>[CustomerInfo_confirmemail]</b></td>
                        <td nowrap><input name="billing_confirmemail" type="text" id="billing_confirmemail" maxlength="50" value="[email]" size="25" class="txtBoxStyle">
                          
                          <!--START: emailrequired--> 
                          <!--START: req_email--> 
                          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" />
                          <!--END: req_email--> 
                          <!--END: emailrequired--></td>
                      </tr>
                      <!--END: confirm_email-->
                      <tr class="item">
                        <td align="right" class="item"><strong>[CustomerInfo_password]: </strong></td>
                        <td>
                            <table border="0" cellpadding="0" cellspacing="0">
                                <tr>
	                                <td >
                                        <input type="password" size="12" name="pass" class="txtBoxStyle" autocomplete="off" [CallFunctionVerifyStrongPass]>
                                        <!--START: passwordrequired--> 
                                        <!--START: req_pass--> 
                                        <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /><!--END: req_pass--> 
                                        <!--END: passwordrequired-->
	                                </td>
                                    <!--START: StrongPasswordBar-->
	                                <td>
		                                <div style="width:100px;height:10px;border:none;background-image: linear-gradient(to left, #00FF00 0%, #FF0000 100%);">
			                            <div id="divStrong" style="width:100%;height:10px;border:none;background-color:white;float:right"></div>
		                                </div>
	                                </td>
                                    <!--END: StrongPasswordBar-->
                                </tr>
                            </table>
                        </td>
                      </tr>
                      <!--START: PasswordMSG-->
                      <tr><td></td><td class="item">[CustomerInfo_password_policy]</td></tr>
                      <!--END: PasswordMSG-->
					  <!--START: recurmessage-->
					  <tr><td colspan="2"><em class="error">[recurringorders_login-required]</em></td></tr>
					  <!--END: recurmessage-->
                      <tr>
                        <td align="right"><input type="checkbox" value="1" name="maillist" [maillist]></td>
                        <td class="item"> [checkout1_joinmailinglist]</td>
                      </tr>
                    </table>
                    <br /></td>
                </tr>
                <!--end create account block--> 
                <!--END: account_login--> 
                <!--START: GIFT_REGISTRY_SHIPPING-->
                <tr>
                  <td class="checkout-headers" colspan="2">[checkout1_Header-giftreg]</td>
                </tr>
                <tr>
                  <td colspan="2" align="left"><table width="100%" cellpadding="3" cellspacing="0" class="alternative">
                      <tr>
                        <td colspan="2" class="item">[checkout1_Header-giftreg-instructions]</td>
                      </tr>
                      <tr>
                        <td colspan="2" class="item"><input type="button" id="cmdRegShip" onclick="javascript:selectRegAddress();" name="cmdRegShip" value="Select Registry Address" class="btn"></td>
                      </tr>
                      <!--tr>
                        <td width="41%" align="right" class="item">
                            <strong>[checkout1_Header-giftreg-shiptofriendaddress]</strong></td>
                        <td><input type="radio" id="chkGiftRegistryShipping" value="friend" name="chkGiftRegistryShipping" checked></td>
                    </tr>                                        
                    <tr>
                        <td width="41%" align="right" class="item">
                            <strong>[checkout1_Header-giftreg-shiptomyaddress]</strong></td>
                        <td><input type="radio" id="chkGiftRegistryShipping" value="my" name="chkGiftRegistryShipping"></td>
                    </tr-->
                    </table>
                    <br /></td>
                </tr>
                <!--END: GIFT_REGISTRY_SHIPPING-->
                <tr>
                  <td class="checkout-headers" colspan="2"> [checkout1_Header-shippinginformation]</td>
                </tr>
                <tr>
                  <td colspan="2" class="error"><!--START: required_fields--> 
                    <img src="assets/templates/common/images/error.gif">&nbsp;<strong>ERROR: PLEASE CHECK THE
                    REQUIRED FIELDS BELOW!</strong> 
                    <!--END: required_fields--></td>
                </tr>
                <tr>
                  <td colspan="2" align="left"><table width="100%" cellpadding="3" cellspacing="0" class="alternative">
                      <!--START: SAVE_ADDRESSES-->
                      <tr>
                        <td width="31%" align="right" class="item"><strong>[checkout1_address-book]</strong></td>
                        <td><select type="dropdown" name="save_address" onchange="javascript:filladdress(this);" id="save_address" class="txtBoxStyle">
                            
                            
                        [address_list]
                        
                          
                          </select></td>
                      </tr>
                      <!--END: SAVE_ADDRESSES-->
                      <tr>
                        <td width="31%" align="right" class="item"><strong>[CustomerInfo_firstname]</strong></td>
                        <td width="59%"><input name="shipping_firstname" type="text" id="shipping_firstname" value="[shipping_firstname]" size="15" class="txtBoxStyle">
                          
                          <!--START: req_shipping_firstname--> 
                          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /><!--END: req_shipping_firstname--></td>
                      </tr>
                      <tr>
                        <td align="right" class="item"><strong>[CustomerInfo_lastname]</strong></td>
                        <td><input name="shipping_lastname" type="text" id="shipping_lastname" value="[shipping_lastname]" size="15" class="txtBoxStyle">
                          
                          <!--START: req_shipping_lastname--> 
                          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /><!--END: req_shipping_lastname--></td>
                      </tr>
                      <tr>
                        <td align="right" class="item"><strong>[CustomerInfo_company]</strong></td>
                        <td><input name="shipping_company" type="text" id="shipping_company" value="[shipping_company]" size="25" class="txtBoxStyle">
                          
                          <!--START: req_shipping_company--> 
                          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /><!--END: req_shipping_company--></td>
                      </tr>
                      <tr>
                        <td align="right" class="item"><strong>[CustomerInfo_phone]</strong></td>
                        <td><input name="shipping_phone" type="text" id="shipping_phone" value="[shipping_phone]" size="25" class="txtBoxStyle">
                          
                          <!--START: req_shipping_phone--> 
                          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /><!--END: req_shipping_phone--></td>
                      </tr>
                      <tr>
                        <td align="right" class="item"><strong>[CustomerInfo_address]</strong></td>
                        <td><input name="shipping_address" type="text" id="shipping_address" value="[shipping_address]" size="25" class="txtBoxStyle">
                          
                          <!--START: req_shipping_address--> 
                          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /><!--END: req_shipping_address--></td>
                      </tr>
                      <tr>
                        <td align="right" class="item"><strong>[CustomerInfo_address2]</strong></td>
                        <td><input name="shipping_address2" type="text" id="shipping_address2" value="[shipping_address2]" size="25" class="txtBoxStyle"></td>
                      </tr>
                      <tr>
                        <td align="right" class="item"><strong>[CustomerInfo_city]</strong></td>
                        <td><input name="shipping_city" type="text" id="shipping_city" value="[shipping_city]" size="25" class="txtBoxStyle">
                          
                          <!--START: req_shipping_city--> 
                          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /><!--END: req_shipping_city--></td>
                      </tr>
                      <tr>
                        <td align="right" class="item"><strong>[CustomerInfo_country]</strong></td>
                        <td><select name="shipping_country" id="shipping_country" onchange="document.checkoutform.action='checkout2.asp?step=2&return=1';document.checkoutform.submit();" class="txtBoxStyle">
                            <!--START: req_shipping_country-->
                                                        *<!--END: req_shipping_country-->
                                                        [CountryDropDown]
                          
                          </select></td>
                      </tr>
                      <tr>
                        <td align="right" class="item"><strong>[CustomerInfo_state]</strong></td>
                        <td> [state] 
                          <!--START: req_shipping_state--> 
                          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /><!--END: req_shipping_state--></td>
                      </tr>
                      <tr>
                        <td align="right" class="item"><strong>[CustomerInfo_zip]</strong></td>
                        <td><input name="shipping_zip" type="text" id="shipping_zip" value="[shipping_zip]" size="10" class="txtBoxStyle">
                          
                          <!--START: req_shipping_zip--> 
                          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /><!--END: req_shipping_zip--></td>
                      </tr>
                      <!--START: addressType-->
                      <tr>
                        <td align="right" class="item"><strong>[CustomerInfo_address_type]</strong></td>
                        <td><select name="shipping_addresstype" class="txtBoxStyle">
                            
                            
                        [addressTypeDropDown]
                        
                          
                          </select></td>
                      </tr>
                      <!--END: addressType-->
<!--START: ADD_ADDRESSBOOK-->
                      <tr id="rowAddAddress" style="display:none;">
                        <td align="right"  class="item"><input type="checkbox" name="addressbook" id="addressbook" value="1"></td>
                        <td class="item"><b>Add&nbsp;to&nbsp;Address&nbsp;Book</b></td>
                      </tr>
<!--END: ADD_ADDRESSBOOK-->

                    </table>
                    <br /></td>
                </tr>
                <!--START: checkout_questions-->
                <tr>
                  <td class="checkout-headers" colspan="2"> [checkout1_checkoutquestions]</td>
                </tr>
                <tr>
                  <td colspan="2" align="left"><table width="100%" cellpadding="2" cellspacing="0" class="alternative">
                      <tr>
                        <td><!--START: questions--> 
                          [questions] 
                          <!--END: questions--></td>
                      </tr>
                    </table></td>
                </tr>
                <!--END: checkout_questions-->
                <tr>
                  <td colspan="2"><!--START: checkout_questions_templates--> 
                    <!--START: textarea-format-->
                    
                    <table>
                      <tr>
                        <td align="right" class="item"><!--START: req[id]--> 
                          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /><!--END: req[id]--><strong>[question]</strong></td>
                        <td><textarea cols="30" rows="5" name="cq[id]" class="txtBoxStyle">[answer]</textarea></td>
                      </tr>
                    </table>
                    
                    <!--END: textarea-format--> 
                    <!--START: text-format-->
                    
                    <table>
                      <tr>
                        <td align="right" class="item"><!--START: req[id]--> 
                          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /><!--END: req[id]--><strong>[question]</strong></td>
                        <td><input type="text" size="30" name="cq[id]" value="[answer]" class="txtBoxStyle"></td>
                      </tr>
                    </table>
                    
                    <!--END: text-format--> 
                    <!--START: file-format--> 
                    [question]<br />
                    <input type="file" name="file[oname]" size="20">
                    <br />
                    
                    <!--END: file-format--> 
                    <!--START: checkbox-format-->
                    
                    <table>
                      <tr>
                        <td><!--START: req[id]--> 
                          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /><!--END: req[id]-->
                          
                          <input type="checkbox" name="cq[id]" class="txtBoxStyle" value="[answer]" [selected]></td>
                        <td align="right" class="item"><strong>[question]</strong></td>
                      </tr>
                    </table>
                    
                    <!--END: checkbox-format--> 
                    <!--START: radio-format-->
                    
                    <table>
                      <tr>
                        <td align="right" class="item"><!--START: req[id]--> 
                          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /><!--END: req[id]--><strong>[question]</strong></td>
                        <td><!--START: option-->
                          
                          <input type="radio" name="cq[id]" value="[option]" class="txtBoxStyle" [selected]>
                          [option]<br />
                          
                          <!--END: option--></td>
                      </tr>
                    </table>
                    
                    <!--END: radio-format--> 
                    <!--START: dropdown-format-->
                    
                    <table>
                      <tr>
                        <td align="right" class="item"><!--START: req[id]--> 
                          <img src="assets/templates/common/images/error2.gif" width="12" height="12" alt="" /><!--END: req[id]--><strong>[question]</strong></td>
                        <td><select name="cq[id]">
                            <!--START: option-->
                            <option [selected]>[option]</option>
                            <!--END: option-->
                          </select></td>
                      </tr>
                    </table>
                    
                    <!--END: dropdown-format--> 
                    <!--END: checkout_questions_templates--></td>
                </tr>
                <tr>
                  <td colspan="2"><span class="error"> <img src="assets/templates/common/images/error2.gif"> = Required</span><br />
                    <br /></td>
                </tr>
                <tr>
                  <td align="left" colspan="2"><div id="divCheckoutButton">
                      <input type="button" onclick="javascript:submitCheckoutForm();" name="btnCheckout" id="btnCheckout" value="[checkout1_submitbutton]" class="btn" onmouseover="this.className='btn_over'" onmouseout="this.className='btn'">
                    </div></td>
                </tr>
              </table></td>
            <!--column left ends--> 
            <!--column right-->
            <td valign="top" width="40%"  align="right"><table width="80%" cellpadding="0" cellspacing="0">
                <tr>
                  <td class="checkout-headers"> [checkout1_Header-shoppingcart]</td>
                </tr>
                <tr>
                  <td><table width="100%" cellpadding="0" cellspacing="0" class="alternative">
                      <!--START: SHOPPING_CART_ITEM-->
                      <tr>
                        <td class="item" align="left">
						<!--START: itemthumbnail--><a href="product.asp?itemid=[ITEM_CATALOGID]"><img src="thumbnail.asp?file=[THUMBNAIL]" border="0" height="40" width="40" id="tl"></a><br /><!--END: itemthumbnail-->
						<!--START: thumbnailnolink--><img src="thumbnail.asp?file=[THUMBNAIL]" border="0" height="40" width="40" id="tnl"><br /><!--END: thumbnailnolink-->
                        <!--START: itemnamelink--><a href="product.asp?itemid=[ITEM_CATALOGID]">[ITEM_NAME]</a><!--END: itemnamelink--> 
						<!--START: itemnamenolink--><span id="spnItemName">[ITEM_NAME]</span><!--END: itemnamenolink-->
                        </td>
                        <td class="item" align="right" valign="bottom"> [ITEM_PRICE] X [ITEM_QUANTITY]<br />
                          <strong>[ITEM_SUBTOTAL]</strong></td>
                      </tr>
                      <tr>
                        <td colspan="2">
						<table width="100%" cellpadding="0" cellspacing="0">
                            <tr>
                              <td class="borders"><img src="assets/images/spacer.gif" width="100%" height="1"></td>
                            </tr>
						</table>
                        </td>
                      </tr>
                      <!--END: SHOPPING_CART_ITEM-->
                      <tr>
                        <td colspan="2">
						  <table width="100%" cellpadding="0" cellspacing="0">
                            <!--START: DISCOUNTS-->
                            <tr>
                              <td align="right" class="item"><strong>[shoppingcart_subtotal]:</strong></td>
                              <td align="right" class="item"> [CARTSUBTOTAL]</td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><strong>[checkout1_discounts]:</strong></td>
                              <td align="right" class="item"> [DISCOUNTS]</td>
                            </tr>
                            <!--END: DISCOUNTS--> 
                            <!--START: BUYSAFE-->
                            <tr>
                              <td align="right" class="item"><img src="assets/templates/common/images/buysafe.gif"></td>
                              <td align="right" class="item"> [buysafe_totalbondcost]</td>
                            </tr>
                            <!--END: BUYSAFE-->
                            <tr>
                              <td align="right" class="price"><strong>[shoppingcart_total]:</strong></td>
                              <td align="right" class="price"> [CARTTOTAL]</td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                      <!--START: GIFTCERTS-->
                      <tr>
                        <td colspan="2" class="titles2" align="right"><span class="item"><strong>[shoppingcart_giftcertificate]</strong></span><br />
                          [GIFTCERTS]</td>
                      </tr>
                      <!--END: GIFTCERTS-->
                    </table></td>
                </tr>
                <tr>
                  <td align="right"><a href="view_cart.asp">Update Cart</a>&nbsp;&nbsp;</td>
                </tr>
              </table></td>
            <!--column right ends--> 
          </tr>
          <tr>
            <td colspan="2"><!--START: CATEGORY_FOOTER-->
              
              <table width="100%" cellspacing="0" cellpadding="2" border="0">
                <tr>
                  <td class="item"> [CONTENT]</td>
                </tr>
              </table>
              
              <!--END: CATEGORY_FOOTER--></td>
          </tr>
        </table></td>
    </tr>
  </table>
</form>
<input type="hidden" name="hdnAddrressValidatorResult" id="hdnAddrressValidatorResult" value="" />
<div id="divAddrressValidator" style="display:none;"> 
  <!--START: AddressValidatorBlock-->
  <div style="background-color: White; padding: 30px; -webkit-box-shadow: 0px 0px 12px rgba(50, 50, 50, 0.5); -moz-box-shadow: 0px 0px 12px rgba(50, 50, 50, 0.5); box-shadow: 0px 0px 12px rgba(50, 50, 50, 0.5);"> 
    <!--START: AddressValidatorBlock_ValidationFailed-->
    <div>[result_msg]</div>
    <!--END: AddressValidatorBlock_ValidationFailed--> 
    <!--START: AddressValidatorBlock_ValidationSuggestion-->
    <div> [result_msg] 
      <!--START: AddressValidatorBlock_ValidationSuggestion_SingleAddressBlock--> 
      <br />
      <br />
      <strong>[checkout1_AddressValidator_SuggestedAddress]</strong> <a style="text-decoration:underline;" href="#" onclick="javascript:parent.jQuery.modal.close();selectAddress('[AddrressValidator_address1]', '[AddrressValidator_address2]', '[AddrressValidator_city]', '[AddrressValidator_state]', '[AddrressValidator_zip]', '[AddrressValidator_rdi]');">[AddrressValidator_address], [AddrressValidator_city], [AddrressValidator_state], [AddrressValidator_zip]</a> 
      <!--END: AddressValidatorBlock_ValidationSuggestion_SingleAddressBlock--> 
      </div>
    <!--END: AddressValidatorBlock_ValidationSuggestion-->
    <!--START: AddressValidatorBlock_ValidationSuggestion_ContinueWithEnteredAddress--> 
    <br />
    <a style="text-decoration:underline;" href="javascript:void(0);" onclick="javascript:parent.jQuery.modal.close();useAddressValidator='';submitCheckoutForm();">[checkout1_AddressValidator_Continue]</a>
	<br />
    <!--END: AddressValidatorBlock_ValidationSuggestion_ContinueWithEnteredAddress--> 
    <br /><a style="text-decoration:underline;" href="javascript:void(0);" onclick="javascript:parent.jQuery.modal.close();">[checkout1_AddressValidator_Close]</a></div>
  <!--END: AddressValidatorBlock-->
</div>

<script type="text/javascript">
function confirmationValidation()
{
    if (document.checkoutform.billing_confirmemail == null || document.checkoutform.billing_confirmemail == 'undefined')
        return true;

    if (document.checkoutform.email.value != document.checkoutform.billing_confirmemail.value)
    {
        alert('The Email does not match.');
        return false;
    }

    return true;
}
</script>
<script type="text/javascript">
    bolCheckSubmitted_validation = false;

    var useAddressValidator = "[useAddressValidator]";

    var frmvalidator = new Validator("checkoutform");
    frmvalidator.EnableMsgsTogether();

    function setValidation()
    {
        frmvalidator.clearAllValidations();

        frmvalidator.addValidation("shipping_firstname","req","Please enter your First Name");
        frmvalidator.addValidation("shipping_firstname","maxlen=20","Max length for First Name is 20");
        frmvalidator.addValidation("shipping_lastname","req","Please enter your Last Name");
        frmvalidator.addValidation("shipping_lastname","maxlen=20","Max length for Last Name is 20");

        frmvalidator.addValidation("shipping_company","maxlen=50","Max length for Company is 50");

        //<!--START: emailrequiredscript-->
        if (document.checkoutform.email != null && document.checkoutform.email != 'undefined')
        {
            frmvalidator.addValidation("email","maxlen=50","Max length for Email is 50");
            frmvalidator.addValidation("email","req","Email is required");
            frmvalidator.addValidation("email","email");
        }
        //<!--END: emailrequiredscript-->

        // <!--START: confirmemailscript--> 
		if (document.checkoutform.billing_confirmemail != null && document.checkoutform.billing_confirmemail != 'undefined')
        {
            frmvalidator.addValidation("billing_confirmemail","maxlen=50","Max length for Email is 50");
            frmvalidator.addValidation("billing_confirmemail","req","Please confirm your Email.");
            frmvalidator.addValidation("billing_confirmemail","email","Please confirm your Email.");
        }
        //<!--END: confirmemailscript-->

		//<!--START: phonerequiredscript-->
		frmvalidator.addValidation("shipping_phone", "maxlen=18", "Max length for Phone is 18");
		frmvalidator.addValidation("shipping_phone", "req", "Please enter your phone number.");
		if (get_Element('shipping_country').value == "US" || get_Element('shipping_country').value == "CA")
		{
            	frmvalidator.addValidation("shipping_phone", "phone", "Invalid phone number.");
        }
        //<!--END: phonerequiredscript-->

	    frmvalidator.addValidation("shipping_address","maxlen=50","Max length for Address is 50");
        frmvalidator.addValidation("shipping_address","req","Please enter your address");

        frmvalidator.addValidation("shipping_address2","maxlen=40","Max length for Suite/Apt# is 40");

        frmvalidator.addValidation("shipping_city","maxlen=50","Max length for City is 50");
        frmvalidator.addValidation("shipping_city","req","Please enter your City");


        if (get_Element('shipping_country').value == "US" || get_Element('shipping_state').type == 'select-one')
        {
            frmvalidator.addValidation("shipping_state","maxlen=50","Max length for State is 50");
            frmvalidator.addValidation("shipping_state","req","Please enter/select your state");
            frmvalidator.addValidation("shipping_zip","maxlen=15","Max length for Zip is 15");
            frmvalidator.addValidation("shipping_zip","req","Please enter your zip code");
        }

        //<!--START: addressTypeScript-->
		    frmvalidator.addValidation("shipping_addresstype","req","Please select [CustomerInfo_address_type]");
       // <!--END: addressTypeScript-->

        //frmvalidator.setAddnlValidationFunction("confirmationValidation");
        //frmvalidator.setAddnlValidationFunction("checkreq_questions1");
        frmvalidator.setAddnlValidationFunction("extraValidations");
    }

    function selectRegAddress()
    {
        location.href='checkout.asp?step=1&gftRegAdd=1';

        //Select without refresh:
        /*
		var objDrop = window.document.getElementById('save_address');

		if (objDrop == null)

		for (var intI = 0; 50; intI++) {
			if (objDrop.options[intI].innerText.trim() == 'Registry Address') {
				objDrop.options[intI].selected = true;
				filladdress(objDrop);
				return false;
			}
		}
		*/
    }
    String.prototype.trim = function() {
        return this.replace(/^\s+|\s+$/g,"");
    }
    var ccNumerNotAllowedMessage = '[ccNumerNotAllowedMessage]';
    function extraValidations()
    {
        if (!checkreq_questions1())
            return false;

        if (!confirmationValidation())
            return false;

        return true;
    }

    function submitCheckoutForm()
    {
        var myCountry = "US";
        if (getElementById_s("shipping_country"))
            myCountry = getElementById_s("shipping_country").value;

        document.body.style.cursor='wait';
        if (getElementById_s("btnCheckout")) getElementById_s("btnCheckout").style.cursor='wait';

        objForm = document.checkoutform;

        setValidation();

        if(objForm.onsubmit()) //triggers the form validation
        {
            if (useAddressValidator == "1" && myCountry == "US")
            {
                isSubmitComplete = false;
                getElementById_s("hdnAddrressValidatorResult").value = "";
                var url = 'addressvalidator.asp?no-cache='+Math.random();
                var params = 'doaction=verify&ct=multi';
                params += '&name=' + getElementById_s("shipping_firstname").value + ' ' + getElementById_s("shipping_lastname").value;
                if (getElementById_s("shipping_company")) params += '&company=' + getElementById_s("shipping_company").value;
                params += '&address=' + getElementById_s("shipping_address").value;
                params += '&address2=' + getElementById_s("shipping_address2").value;
                params += '&city=' + getElementById_s("shipping_city").value;
                params += '&state=' + getElementById_s("shipping_state").value;
                params += '&zip=' + getElementById_s("shipping_zip").value;

                var ajax = new Ajax.Updater({success: 'divAddrressValidator'},
				url,
				{method: 'post', evalScripts: true, parameters: params, onFailure: reportError});
            }
            else
            {
                document.body.style.cursor='';
                if (getElementById_s("btnCheckout")) getElementById_s("btnCheckout").style.cursor='';
                if (getElementById_s("divAddrressValidator") != null && getElementById_s("divAddrressValidator") != 'undefined')
                    getElementById_s("divAddrressValidator").style.display = 'none';

                objForm.submit();
            }
        }
        else
        {
            document.body.style.cursor='';
            if (getElementById_s("btnCheckout")) getElementById_s("btnCheckout").style.cursor='';
        }
    }

    function submitCheckoutFormPos()
    {
        objForm = document.checkoutform;
        if (getElementById_s("hdnAddrressValidatorResult").value == "1")
        {
            objForm.submit();
            return;
        }
        else
        {
            isSubmitComplete = false;

            jQuery("#divAddrressValidator").modal({containerCss:{borderWidth:"1px"}});
            document.body.style.cursor='';
            if (getElementById_s("btnCheckout")) getElementById_s("btnCheckout").style.cursor='';
        }

    }

    function selectAddress(AddrressValidator_address1, AddrressValidator_address2, AddrressValidator_city, AddrressValidator_state, AddrressValidator_zip, AddressValidator_RDI)
    {
        getElementById_s("shipping_address").value = AddrressValidator_address1;
        getElementById_s("shipping_address2").value = AddrressValidator_address2;
        getElementById_s("shipping_city").value = AddrressValidator_city;
        getElementById_s("shipping_zip").value = AddrressValidator_zip;
        getElementById_s("shipping_state").value = AddrressValidator_state;
        useAddressValidator='';
        //AddressValidator_RDI
        if (getElementById_s("shipping_addresstype") && AddressValidator_RDI != ""){
            if (AddressValidator_RDI == "R")
                getElementById_s("shipping_addresstype").value = "1";
            else
                getElementById_s("shipping_addresstype").value = "2";
        }

        submitCheckoutForm();
    }

    function reportError(request) {
        isSubmitComplete = false;
        //request.responseText
        alert("Error processing request " + request.responseText);
    }

    function getElementById_s(id){
        var obj = null;
        if(document.getElementById){
            /* Prefer the widely supported W3C DOM method, if
			available:-
			*/
            obj = get_Element(id);
        }else if(document.all){
            /* Branch to use document.all on document.all only
			browsers. Requires that IDs are unique to the page
			and do not coincide with NAME attributes on other
			elements:-
			*/
            obj = document.all[id];
        }
        /* If no appropriate element retrieval mechanism exists on
		this browser this function always returns null:-
		*/
        return obj;
    }
</script> 
