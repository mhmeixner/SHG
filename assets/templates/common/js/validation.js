Validator=Class.create(),Validator.prototype={initialize:function(n,t,i,r){this.options=Object.extend({},r||{}),this._test=i?i:function(){return!0},this.error=t?t:"Validation failed.",this.className=n},test:function(n,t){return this._test(n,t)}};var Validation=Class.create();Validation.prototype={initialize:function(n,t){if(this.options=Object.extend({onSubmit:!0,stopOnFirst:!1,immediate:!1,focusOnError:!0,useTitles:!1,onFormValidate:function(){},onElementValidate:function(){}},t||{}),this.form=$(n),this.options.onSubmit&&Event.observe(this.form,"submit",this.onSubmit.bind(this),!1),this.options.immediate){var i=this.options.useTitles,r=this.options.onElementValidate;Form.getElements(this.form).each(function(n){Event.observe(n,"blur",function(n){Validation.validate(Event.element(n),{useTitle:i,onElementValidate:r})})})}},onSubmit:function(n){this.validate()||Event.stop(n)},validate:function(){var n=!1,t=this.options.useTitles,i=this.options.onElementValidate;n=this.options.stopOnFirst?Form.getElements(this.form).all(function(n){return Validation.validate(n,{useTitle:t,onElementValidate:i})}):Form.getElements(this.form).collect(function(n){return Validation.validate(n,{useTitle:t,onElementValidate:i})}).all(),!n&&this.options.focusOnError&&Form.getElements(this.form).findAll(function(n){return $(n).hasClassName("validation-failed")}).first().focus();this.options.onFormValidate(n,this.form);return n},reset:function(){Form.getElements(this.form).each(Validation.reset)}},Object.extend(Validation,{validate:function(n,t){t=Object.extend({useTitle:!1,onElementValidate:function(){}},t||{}),n=$(n);var i=n.classNames();return result=i.all(function(i){var r=Validation.test(i,n,t.useTitle);t.onElementValidate(r,n);return r})},test:function(n,t,i){var u=Validation.get(n),f="__advice"+n.camelize(),o,e,r;if(Validation.isVisible(t)&&!u.test($F(t),t)){if(!t[f]){if(r=Validation.getAdvice(n,t),typeof r=="undefined"){o=i?t&&t.title?t.title:u.error:u.error,r='<div class="validation-advice" id="advice-'+n+"-"+Validation.getElmID(t)+'" style="display:none">'+o+"<\/div>";switch(t.type.toLowerCase()){case"checkbox":case"radio":e=t.parentNode,e?new Insertion.Bottom(e,r):new Insertion.After(t,r);break;default:new Insertion.After(t,r)}r=$("advice-"+n+"-"+Validation.getElmID(t))}typeof Effect=="undefined"?r.style.display="block":new Effect.Appear(r,{duration:1})}return t[f]=!0,t.removeClassName("validation-passed"),t.addClassName("validation-failed"),!1}return r=Validation.getAdvice(n,t),typeof r!="undefined"&&r.hide(),t[f]="",t.removeClassName("validation-failed"),t.addClassName("validation-passed"),!0},isVisible:function(n){while(n.tagName!="BODY"){if(!$(n).visible())return!1;n=n.parentNode}return!0},getAdvice:function(n,t){return Try.these(function(){return $("advice-"+n+"-"+Validation.getElmID(t))},function(){return $("advice-"+Validation.getElmID(t))})},getElmID:function(n){return n.id?n.id:n.name},reset:function(n){n=$(n);var t=n.classNames();t.each(function(t){var i="__advice"+t.camelize(),r;n[i]&&(r=Validation.getAdvice(t,n),r.hide(),n[i]=""),n.removeClassName("validation-failed"),n.removeClassName("validation-passed")})},add:function(n,t,i,r){var u={};u[n]=new Validator(n,t,i,r),Object.extend(Validation.methods,u)},addAllThese:function(n){var t={};$A(n).each(function(n){t[n[0]]=new Validator(n[0],n[1],n[2],n.length>3?n[3]:{})}),Object.extend(Validation.methods,t)},get:function(n){return Validation.methods[n]?Validation.methods[n]:new Validator},methods:{}}),Validation.add("IsEmpty","",function(n){return n==null||n.length==0}),Validation.addAllThese([["required","This is a required field.",function(n){return!Validation.get("IsEmpty").test(n)}],["validate-number","Please enter a valid number in this field.",function(n){return Validation.get("IsEmpty").test(n)||!isNaN(n)&&!/^\s+$/.test(n)}],["validate-digits","Please use numbers only in this field. please avoid spaces or other characters such as dots or commas.",function(n){return Validation.get("IsEmpty").test(n)||!/[^\d]/.test(n)}],["validate-alpha","Please use letters only (a-z) in this field.",function(n){return Validation.get("IsEmpty").test(n)||/^[a-zA-Z]+$/.test(n)}],["validate-alphanum","Please use only letters (a-z) or numbers (0-9) only in this field. No spaces or other characters are allowed.",function(n){return Validation.get("IsEmpty").test(n)||!/\W/.test(n)}],["validate-date","Please enter a valid date.",function(n){var t=new Date(n);return Validation.get("IsEmpty").test(n)||!isNaN(t)}],["validate-email","Please enter a valid email address. For example fred@domain.com .",function(n){return Validation.get("IsEmpty").test(n)||/\w{1,}[@][\w\-]{1,}([.]([\w\-]{1,})){1,3}$/.test(n)}],["validate-url","Please enter a valid URL.",function(n){return Validation.get("IsEmpty").test(n)||/^(http|https|ftp):\/\/(([A-Z0-9][A-Z0-9_-]*)(\.[A-Z0-9][A-Z0-9_-]*)+)(:(\d+))?\/?/i.test(n)}],["validate-date-au","Please use this date format: dd/mm/yyyy. For example 17/03/2006 for the 17th of March, 2006.",function(n){var i,t;return Validation.get("IsEmpty").test(n)?!0:(i=/^(\d{2})\/(\d{2})\/(\d{4})$/,!i.test(n))?!1:(t=new Date(n.replace(i,"$2/$1/$3")),parseInt(RegExp.$2,10)==1+t.getMonth()&&parseInt(RegExp.$1,10)==t.getDate()&&parseInt(RegExp.$3,10)==t.getFullYear())}],["validate-currency-dollar","Please enter a valid $ amount. For example $100.00 .",function(n){return Validation.get("IsEmpty").test(n)||/^\$?\-?([1-9]{1}[0-9]{0,2}(\,[0-9]{3})*(\.[0-9]{0,2})?|[1-9]{1}\d*(\.[0-9]{0,2})?|0(\.[0-9]{0,2})?|(\.[0-9]{1,2})?)$/.test(n)}],["validate-one-required","Please select one of the above options.",function(n,t){var i=t.parentNode,r=i.getElementsByTagName("INPUT");return $A(r).any(function(n){return $F(n)})}]])