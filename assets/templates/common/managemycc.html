<script type="text/javascript" src="state_countryjs.asp"></script><script>


	function editCard(isEdit)
	{

		if (isEdit)
		{
			document.getElementById('divCard').style.display = 'none';
			document.getElementById('divCardEdit').style.display = '';
			document.getElementById('hdnEditCard').value = "1";
		}
		else
		{
			document.getElementById('divCard').style.display = '';
			document.getElementById('divCardEdit').style.display = 'none';
			document.getElementById('hdnEditCard').value = "0";
		}
	}



</script> <form action="managemycc.asp" name="frmForm" id="frmForm" method="post">
<input type="hidden" id="hdnAction" name="hdnAction" value="">
<input type="hidden" id="pp" name="pp" value="[strCustomerPaymentProfileId]">
<input type="hidden" id="hdnEditCard" name="hdnEditCard" value="[hdnEditCardValue]">
<table width="95%" cellpadding="0" cellspacing="0">
	<tr>
		<td colspan="2">&nbsp;</td>
	</tr>
	<tr>
		<td class="page_headers" align="left" colspan="2">[account_creditcard-details]</td>
	</tr>
	<tr>
		<td colspan="2">&nbsp;</td>
	</tr>
	<!--START: CATEGORY_HEADER-->
	<tr>
		<td class="data" colspan="2">[CONTENT]</td>
	</tr>
	<tr>
		<td>&nbsp;</td>
	</tr>
	<!--END: CATEGORY_HEADER-->
	<!--START: ERROR_MSG-->
	<tr>
		<td class="error" colspan="2"><b>[strErrMsg]</b></td>
	</tr>
	<!--END: ERROR_MSG-->
	<tr>
		<td colspan="2">&nbsp;</td>
	</tr>
	<tr>
		<td class="checkout-headers" colspan="2">[account_creditcard-info]</td>
	</tr>
	<tr>
		<td align="left" colspan="2"><div id="divCardEdit" name="divCardEdit" style="display:[ShowCardEdit];">
			<table border="0" cellpadding="2" cellspacing="0" width="100%">
				<tr>
					<td width="31%" class="item" align="right"><b>[CustomerInfo_creditcardnumber]</b></td>
					<td class="item"><input type="text" id="card_number" name="card_number" maxlength="20" size="25" value="[card_number]" class="txtBoxStyle" [card_number_disabled]></td>
				</tr>
				<tr>
					<td class="item" align="right"><b>[CustomerInfo_creditexpiration]</b></td>
					<td class="item"><select name="drpMonth" id="drpMonth" class="txtBoxStyle">
							<!--START: drpRegMonth-->
							<option value="[intMonth]" [selected]>[month]</option>
							<!--END: drpRegMonth-->
						</select>
						&nbsp;
						<select name="drpYear" id="drpYear" class="txtBoxStyle">
							<!--START: drpRegYear-->
							<option value="[year]" [selected]>[year]</option>
							<!--END: drpRegYear-->
						</select>
					</td>
				</tr>
				<!--tr>
					<td class="item" align="right"><b>CVV2</b></td>
					<td class="item"><input type="text" name="card_cvv2" size="3" class="txtBoxStyle" id="card_cvv2" value="XXX"></td>
				</tr-->
				<!--START: CanceleditCard-->
				<tr>
					<td class="item" align="right"><b></b></td>
					<td class="item"><a href="#" onclick="javascript:editCard(false);">[account_button-cancel]</a> </td>
				</tr>
				<!--END: CanceleditCard-->
			</table>
			</div><div id="divCard" name="divCard" style="display:[ShowCard];">
			<table border="0" cellpadding="2" cellspacing="0" width="100%">
				<tr>
					<td width="31%" class="item" align="right"><b>[CustomerInfo_creditcardnumber]</b></td>
					<td class="item">[card_number]
						<input type="hidden" id="card_number_original" name="card_number_original" value="[card_number]"></td>
				</tr>
				<tr>
					<td class="item" align="right"><b>[CustomerInfo_creditexpiration]</b></td>
					<td class="item"> [month]
						-
						[year]
						<input type="hidden" id="drpMonth_original" name="drpMonth_original" value="[month]">
						<input type="hidden" id="drpYear_original" name="drpYear_original" value="[year]">
					</td>
				</tr>
				<!--tr>
					<td class="item" align="right"><b>CVV2</b></td>
					<td class="item">XXX<input type="hidden" id="card_cvv2_original" name="card_cvv2_original" value="XXX"></td>
				</tr-->
				<!--START: editCard-->
				<tr>
					<td class="item" align="right"><b></b></td>
					<td class="item"><a href="#" onclick="javascript:editCard(true);">[account_creditcard-edit]</a> </td>
				</tr>
				<!--END: editCard-->
			</table>
			</div></td>
	</tr>
	<tr>
		<td colspan="2">&nbsp;</td>
	</tr>
	<tr>
		<td class="checkout-headers" colspan="2">[account_billing-info]</td>
	</tr>
	<tr>
		<td align="left" colspan="2"><table border="0" cellpadding="2" cellspacing="0" width="100%">
				<!--START: authNet-->
				<tr>
					<td width="31%" align="right" class="item"><b>[CustomerInfo_firstname]</b></td>
					<td nowrap><input name="billing_firstname" type="text" id="billing_firstname" maxlength="50" value="[billing_firstname]" size="15" class="txtBoxStyle">
				</tr>
				<tr>
					<td align="right" class="item"><b>[CustomerInfo_lastname]</b></td>
					<td nowrap><input name="billing_lastname" type="text" id="billing_lastname" maxlength="50" value="[billing_lastname]" size="15" class="txtBoxStyle">
					</td>
				</tr>
				<!--START: company-->
				<tr>
					<td align="right" class="item"><b>[CustomerInfo_company]</b></td>
					<td><input name="billing_company" type="text" id="billing_company" maxlength="50" value="[billing_company]" size="25" class="txtBoxStyle">
					</td>
				</tr>
				<!--END: company-->
				<!--END: authNet-->
				<tr>
					<td align="right" class="item"><b>[CustomerInfo_address]</b></td>
					<td nowrap><input name="billing_address" type="text" id="billing_address" maxlength="60" value="[billing_address]" size="25" class="txtBoxStyle">
				</tr>
				<!--START: address2-->
				<tr>
					<td align="right" class="item"><b>[CustomerInfo_address2]</b></td>
					<td nowrap><input name="billing_address2" type="text" id="billing_address2" maxlength="60" value="[billing_address2]" size="25" class="txtBoxStyle">
				</tr>
				<!--END: address2-->
                <!--START: city-->
				<tr>
					<td align="right" class="item"><b>[CustomerInfo_city]</b></td>
					<td nowrap><input name="billing_city" type="text" id="billing_city" maxlength="40" value="[billing_city]" size="25" class="txtBoxStyle">
				</tr>
                <!--END: city-->
                <!--START: country-->
				<tr>
					<td align="right" class="item"><b>[CustomerInfo_country]</b></td>
					<td nowrap><select name="billing_country" onChange="this.form.billing_zip.value='';populateState('billing_state','billing_country');check_stateValidator('billing');check_address('billing');" class="txtBoxStyle" id="billing_country">
						</select>
				</tr>
                <!--END: country-->
                <!--START: state-->
				<tr>
					<td align="right" class="item"><b>[CustomerInfo_state]</b></td>
					<td nowrap><span>
						<select id="billing_state" onChange="this.form.billing_zip.value='';check_address('billing');" name="billing_state" class="txtBoxStyle">
						</select>
						</span> </td>
				</tr>
                <!--END: state-->
				<tr>
					<td align="right" class="item"><b>[CustomerInfo_zip]</b></td>
					<td nowrap><input name="billing_zip" maxlength="20" type="text" id="billing_zip" value="[billing_zip]" size="10" class="txtBoxStyle" onChange="clearContent(this);check_address('billing');" >
					</td>
				</tr>
			</table></td>
	</tr>
	<tr>
		<td colspan="2">&nbsp;</td>
	</tr>
	<tr>
		<td colspan="2" align="left"><input type="button" id="cmdCancel" name="cmdCancel" onclick="javascript:location.href='myaccount.asp';" class="btn" value="[account_button-back]" onMouseOver="this.className='btn_over'" onMouseOut="this.className='btn'">
			<input type="button" id="cmdDelete" name="cmdDelete" onclick="javascript:deleteProfile();" class="btn" value="[account_button-delete]" onMouseOver="this.className='btn_over'" onMouseOut="this.className='btn'">
			<!--START: save--><input type="button" id="cmdSave" name="cmdSave" onclick="javascript:saveProfile();" class="btn" value="[account_button-Save]" onMouseOver="this.className='btn_over'" onMouseOut="this.className='btn'"><!--END: save-->
		</td>
	</tr>
	<tr>
		<td>&nbsp;</td>
	</tr>
	<!--START: CATEGORY_FOOTER-->
	<tr>
		<td class="data" colspan="2">&nbsp;[CONTENT]</td>
	</tr>
	<!--END: CATEGORY_FOOTER-->
</table>
</form><script>
initCountry('[billing_country]','[billing_state]','billing_state','billing_country');

function deleteProfile()
{
	var rep = confirm("[account_creditcard-delete-confirmation]");
	
	if (rep)
	{
		document.frmForm.hdnAction.value = "delete";
		document.frmForm.submit();
	}
}

function saveProfile()
{
	var strMsg = "";
	if (document.frmForm.card_number.value.trim() == "")
		strMsg += " - [CustomerInfo_creditcardnumber] cannot be blank.\n";
	if (document.frmForm.drpMonth.value.trim() == "" || document.frmForm.drpYear.value.trim() == "")
		strMsg += " - [CustomerInfo_creditexpiration] is invalid.\n";
		
	//<!--START: authNetValidation-->
	if (document.frmForm.billing_firstname.value.trim() == "")
		strMsg += " - [CustomerInfo_firstname] cannot be blank.\n";
	if (document.frmForm.billing_lastname.value.trim() == "")
		strMsg += " - [CustomerInfo_lastname] cannot be blank.\n";
	//<!--END: authNetValidation-->

	if (document.frmForm.billing_address.value.trim() == "")
	    strMsg += " - [CustomerInfo_address] cannot be blank.\n";

    //<!--START: CityValidation-->
	if (document.frmForm.billing_city.value.trim() == "")
		strMsg += " - [CustomerInfo_city] cannot be blank.\n";
	//<!--END: CityValidation-->

    //<!--START: CountryValidation-->
	if (document.frmForm.billing_country.value.trim() == "")
		strMsg += " - [CustomerInfo_country] cannot be blank.\n";
    //<!--END: CountryValidation-->

    //<!--START: StateValidation-->
	if (document.frmForm.billing_state.value.trim() == "")
		strMsg += " - [CustomerInfo_state] cannot be blank.\n";
    //<!--END: StateValidation-->   

	if (document.frmForm.billing_zip.value.trim() == "")
		strMsg += " - [CustomerInfo_zip] cannot be blank.\n";

	if (strMsg != ""){
		alert(strMsg);
		return false;
	}
	document.frmForm.hdnAction.value = "save";
	document.frmForm.submit();
}

String.prototype.trim = function() {
	return this.replace(/^\s+|\s+$/g,"");
}
</script> 
